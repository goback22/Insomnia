<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"  
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<!-- namespace속성:매퍼파일의 완전한경로 .xml는 생략 -->
<!-- ※ibatis와는 다르게 id값에 .(dot)를 사용 못한다. -->

<mapper namespace="mapper.sgh">

	<select id="isSocialMember" parameterType="java.util.Map" resultType="int">
		select count(*) from members where id=#{socialId}
	</select>

	<insert id="socialRegister" parameterType="java.util.Map">
		insert into members(id, email, name, profile_img, birthday, join_date, login_chain, phone) 
		values(#{socialId}, #{socialEmail}, #{socialName}, #{socialProfile}, #{socialBirth}, sysdate, 'facebook', 010)
	</insert>
	
	<select id="selectOne_Member" parameterType="java.util.Map" resultType="MemberDTO">
		select * from members where id=#{id}
	</select>
	
	<select id="selectList_reward" parameterType="java.util.Map" resultType="RewardDTO">
		select r_no, r_price, r_name, s_no, r_description, b_name, bm_name, s_album_cover from (select r.*, bm_name , b_name, s_album_cover from reward r join safepay s on r.r_no = s.r_no
		join bandsubmit bs on bs.s_no = r.s_no
		join band b on b.b_no = bs.b_no
		join bandmusic bm on bm.b_no = b.b_no
        where id = #{id}
        )
	</select>
	
	<update id="update_Member" parameterType="java.util.Map">
		update members set profile_img = #{profile_img} where id = #{id}
	</update>
	

</mapper>
